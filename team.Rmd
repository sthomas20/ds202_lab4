---
title: "Team file"
author: "Sonia Thomas and John Nownes"
date: "3/11/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
library(readxl)
library(reshape2)
library(dplyr)
library(tidyr)
library(ggplot2)
defense <- read_excel('cyclonesFootball2019.xlsx', sheet='Defensive')
offense <- read_excel('cyclonesFootball2019.xlsx', sheet='Offensive')
bio<- read_excel('cyclonesFootball2019.xlsx', sheet='Biography')
```

## Lab 4

### Part one: Cleaning the Data

#### Questions 1-3

```{r }
defClean<- defense %>% 
  mutate(Name =as.factor(Name)) %>%
  mutate(Opponent_Opponent = as.factor(Opponent_Opponent)) %>%
  mutate_at(vars(contains("Tackles")), funs(as.numeric)) %>%
  mutate_at(vars(contains("Turnover")), funs(as.numeric)) %>%
  mutate_at(vars(contains("Pass")), funs(as.numeric)) 
  
str(defClean)

offClean<- offense %>% 
  mutate(Name =as.factor(Name)) %>%
  mutate(Opponent_Opponent = as.factor(Opponent_Opponent)) %>%
  mutate_at(vars(contains("Rushing")), funs(as.numeric)) %>%
  mutate_at(vars(contains("Receiving")), funs(as.numeric)) %>%
  mutate_at(vars(contains("Passing")), funs(as.numeric)) 
 
str(offClean)

bioClean<- bio %>% 
  mutate(Name =as.factor(Name)) %>%
  mutate_at(vars(contains("Weight")), funs(as.numeric)) %>%
  separate(Height, into = c("ft", "inches")) %>%
  mutate(Height = as.numeric(ft)*12 + as.numeric(inches)) %>%
  select(-c(ft, inches)) %>%
  select(1:2, Height, everything())
  
str(bioClean)
```

### Part two: Tidying (1)

1.
    ```{r}
    defClean = defClean %>%
      pivot_longer(Tackles_Solo:Pass_PB, names_to = 'Statistic')
    ```
    
2. 
    ```{r}
    defClean %>%
      ggplot(aes(value)) + geom_histogram(binwidth = .5) + facet_wrap(~Statistic) + ggtitle("Defensive Statistic Histograms")
    ```
    * Looking at the above plot of all the defensive histograms, it is clear that the three turnover categories (forced fumble, fumble recovery, and interceptions) are the most rare defensive statistics. Sacks are also quite rare as well.
    
3.
    ```{r}
    dat2_3 = defClean %>%
  filter(Opponent_Opponent == "West Virginia" | Opponent_Opponent == "Kansas State", Statistic == "Tackles_Solo") %>%
  pivot_wider(names_from = Opponent_Opponent, values_from =  value)

dat2_3$`West Virginia`[is.na(dat2_3$`West Virginia`)] = 0
dat2_3$`Kansas State`[is.na(dat2_3$`Kansas State`)] = 0
dat2_3 = dat2_3 %>%
  filter(`West Virginia` != 0 | `Kansas State` != 0)

p = dat2_3 %>%
  ggplot(aes(x = `West Virginia`, y = `Kansas State`)) + geom_count() + coord_cartesian(xlim = c(0,6))
p = p + ggtitle("Scatter Plot of Solo Tackles For Each Player\n Against West Virginia and Kansas State")
p
    ```
    * Iowa State had a better defense against Kansas State, based on the comparison of the total solo tackles against each team. From the plot above, you can tell that most individual players recorded a higher number of solo tackles against Kansas State than they did against West Virginia. In addition, by summing the total number of solo tackles against each team, we see that ISU tallied 45 total solo tackles against Kansas State and only 34 total solo tackles against West Virginia.
    
### Part two: Tidying (2)

1.
    ```{r}
    
    ```
    
2.
    ```{r}
    
    ```
    
    
### Part three: Joining data frames

1.
    ```{r}
    
    ```
    
2.
    ```{r}
    
    ```
    
3.
    ```{r}
    
    ```
    
4.
    ```{r}
    
    ```